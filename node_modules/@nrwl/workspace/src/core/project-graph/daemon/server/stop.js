"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
/**
 * NOTE: This file is intended to be executed as a script by utilities found in ./index.ts
 */
const devkit_1 = require("@nrwl/devkit");
const cache_1 = require("../cache");
const server_1 = require("./server");
(() => tslib_1.__awaiter(void 0, void 0, void 0, function* () {
    try {
        yield server_1.stopServer();
        // Clean up any orphaned background process and clear cached metadata
        const cachedDaemonJson = yield cache_1.readDaemonJsonCache();
        if (cachedDaemonJson) {
            if (cachedDaemonJson.backgroundProcessId) {
                process.kill(cachedDaemonJson.backgroundProcessId);
            }
            cache_1.deleteDaemonJsonCache();
        }
    }
    catch (err) {
        devkit_1.logger.error(err);
    }
}))();
//# sourceMappingURL=stop.js.map